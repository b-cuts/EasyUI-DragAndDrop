<!DOCTYPE html>
<html>
    <head>
      <meta charset="utf-8">
      <link href="../dist/easyui-draganddrop.css" rel="stylesheet" type="text/css" media="all"/>
      <link href="example.css" rel="stylesheet" type="text/css" media="all"/>

      <title>EasyUI-DragAndDrop Example</title>
    </head>
    <body>

        <div style="display:none;">
            <ul>
                <li class="directory" id="directory">
                    <button class="toggle"> </button><button class="name"></button>
                    <ul class="entries"></ul>
                </li>
                <li class="file" id="file">
                    <button class="name"></button>
                </li>
                <li class="marker" id="marker">
                    <button class="name"></button>
                </li>
            </ul>
        </div>

        <script src="./lib/easyui.js"> </script>

        <script src="../dist/easyui-draganddrop.js"> </script>

        <script>

      (function() {

        var Body = easyUI.Body;

        var Explorer = easyUIDragAndDrop.Explorer,
            RubbishBin = easyUIDragAndDrop.RubbishBin;

        var firstExplorer = Explorer.fromHTML('<ul class="explorer"> </ul>', 'First explorer', onActivateFile, onMoveFile, onMoveDirectory),
            secondExplorer = Explorer.fromHTML('<ul class="explorer"> </ul>', 'Second explorer', onActivateFile, onMoveFile, onMoveDirectory),
            rubbishBin = RubbishBin.fromHTML('<div class="rubbishBin"> </div>', onRemoveFile, onRemoveDirectory);

        firstExplorer.addDroppableElement(secondExplorer);
        secondExplorer.addDroppableElement(firstExplorer);
        firstExplorer.addDroppableElement(rubbishBin);
        secondExplorer.addDroppableElement(rubbishBin);

        var body = new Body();

        body.append(firstExplorer);
        body.append(secondExplorer);
        body.append(rubbishBin);

        secondExplorer.addDirectory('Second explorer/First directory');
        secondExplorer.addDirectory('Second explorer/Second directory');

        secondExplorer.addFile('Second explorer/First directory/First file.fls');
        secondExplorer.addFile('Second explorer/First directory/Second file.fls');

        function onActivateFile(path) {
          console.log('activateFile: ' + path)
        }

        function onMoveFile(sourcePath, targetPath, cb) {
          console.log('move file: ' + sourcePath + ' -> ' + targetPath)

//          if (sourcePath === 'Second explorer/First directory/First file.fls') {
//            console.log('...deleted.')
//
//            return null;
//          }
//
//          if (sourcePath === 'Second explorer/First directory/Second file.fls') {
//            console.log('...left in place.')
//
//            return sourcePath;
//          }
//
//          return targetPath;

          setTimeout(function() {
            cb(targetPath);
          }, 1000);
        }

        function onMoveDirectory(sourcePath, targetPath, cb) {
          console.log('move directory: ' + sourcePath + ' -> ' + targetPath)

          if (sourcePath === 'Second explorer/First directory') {
            console.log('...left in place.')

            cb(sourcePath);

            return;
          }

          cb(targetPath);

          return;
        }

        function onRemoveFile(sourcePath, cb) {
          console.log('remove file: ' + sourcePath)

          if (sourcePath === 'Second explorer/First directory/Second file.fls') {
            console.log('...left in place.')

            cb(sourcePath);

            return;
          }

          cb(null);

          return;
        }

        function onRemoveDirectory(sourcePath) {
          console.log('remove directory: ' + sourcePath)

          if (sourcePath === 'Second explorer/First directory') {
            console.log('...left in place.')

            return sourcePath;
          }

          if (sourcePath === 'Second explorer/First directory') {
            console.log('...left in place.')

            return sourcePath;
          }

          return null;
        }

      })();

        </script>
    </body>
</html>
